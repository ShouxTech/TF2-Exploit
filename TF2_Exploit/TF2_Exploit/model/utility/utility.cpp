#include <time.h>
#include <algorithm>
#include <cmath>
#include "utility.h"

std::string utility::create_random_string(int length) {
    std::string random_string;

    char alphanum[] =
        "0123456789"
        "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
        "abcdefghijklmnopqrstuvwxyz";

    srand((unsigned)time(NULL));

    random_string.reserve(length);

    for (int i = 0; i < length; ++i)
        random_string += alphanum[rand() % (sizeof(alphanum) - 1)];

    return random_string;
}

std::string utility::to_lower_case(std::string string) {
    std::transform(string.begin(), string.end(), string.begin(),
        [](unsigned char character) { return std::tolower(character); }
    );
    return string;
}

// Arguments should be 0-1. Returns RGB in 0-1.
void utility::hsv_to_rgb(float h, float s, float v, float rgb_array[4]) {
    h = h * 360;
    float c = s * v;
    float x = c * (1 - std::abs(std::fmod(h / 60.0, 2) - 1));
    float m = v - c;
    float r, g, b;

    if (h >= 0 && h < 60) {
        r = c, g = x, b = 0;
    } else if (h >= 60 && h < 120) {
        r = x, g = c, b = 0;
    } else if (h >= 120 && h < 180) {
        r = 0, g = c, b = x;
    } else if (h >= 180 && h < 240) {
        r = 0, g = x, b = c;
    } else if (h >= 240 && h < 300) {
        r = x, g = 0, b = c;
    } else {
        r = c, g = 0, b = x;
    }

    r += m;
    g += m;
    b += m;

    rgb_array[0] = r;
    rgb_array[1] = g;
    rgb_array[2] = b;
}